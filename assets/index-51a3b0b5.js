import{i,e as V,o as O,C as E,l as u,w as r,k as l,F as M,D as T,m as x,n as d,x as b,G as q,h as J,H as R}from"./index-c87b5650.js";import{N,a as m,b as K}from"./DataTable-2717c282.js";import{a as n,N as A}from"./FormItem-f8acd03a.js";import{N as I}from"./Checkbox-81dc7921.js";const P=["index","唯一ID","所属工程","ID","更新状态","清单编号","清单项目名称","项目特征描述","计量单位","工程量","综合单价a","主材/设备b","安装c","人工d","机械e","辅材f","(管理+利润)g","品牌","产地","栋号名称","区域","价格类型","变更编号","专业名称","包名称","一级系统","二级系统","一级物料","二级物料","包商名称","发生时间","修改时间","添加时间","录入人","编号","合价","分摊措施费","分摊其他费","分摊规费","分摊税金","合价含措施费","合价含措施费、其他费","合价含措施费、其他费、规费","合价含措施费、其他费、规费、税金"],Y=Object.assign({name:"queryData"},{__name:"index",setup(G){const z=i(null),F=i("small"),t=i({selectValueProjectName:"",selectValueProjectNames:["京东方B17项目180K扩产设计项目"],selectValueFilter1:"栋号名称",selectValueFilter2:"专业名称",selectValueMajorName:"",selectValueLv1:"",selectValueLv2:"",selectValueItemLv1:"",selectValueItemLv2:"",selectValueBuildingCategory:"",selectValueBuildingName:"",selectValuePackageName:"",selectValueFilterName1:"",selectValueFilterName2:"",selectValueFloorage:"建筑面积",inputValue:{itemName:"",itemCharacteristic:""}});V(()=>"分类1:"+(t.value.selectValueFilter1||"请先选择分类1")),V(()=>"分类2:"+(t.value.selectValueFilter2||"请先选择分类2"));const U={selectValueProjectName:{trigger:["blur","change"],message:"请选择 selectValue"}},s=i({filter1:["栋号名称","包名称","专业名称","一级系统","二级系统","一级物料","二级物料"].map(e=>({label:e,value:e})),filter2:["栋号名称","包名称","专业名称","一级系统","二级系统","一级物料","二级物料"].map(e=>({label:e,value:e})),floorageNames:["建筑面积","洁净面积","核心面积","精装面积","普装面积"].map(e=>({label:e,value:e}))});V(()=>{let e=s.value.buildingNames;switch(console.log(t.value.selectValueFilter1),t.value.selectValueFilter1){case"栋号名称":e=s.value.buildingNames;break;case"包名称":e=s.value.packageNames;break;case"专业名称":e=s.value.majorNames;break;case"一级系统":e=s.value.lv1;break;case"二级系统":e=s.value.lv2;break;case"一级物料":e=s.value.itemLv1;break;case"二级物料":e=s.value.itemLv2;break}return e}),V(()=>{let e=s.value.buildingNames;switch(console.log(t.value.selectValueFilter2),t.value.selectValueFilter2){case"栋号名称":e=s.value.buildingNames;break;case"包名称":e=s.value.packageNames;break;case"专业名称":e=s.value.majorNames;break;case"一级系统":e=s.value.lv1;break;case"二级系统":e=s.value.lv2;break;case"一级物料":e=s.value.itemLv1;break;case"二级物料":e=s.value.itemLv2;break}return e}),i([{label:"在这里选择要查询的项目的名称",value:"",disabled:!0}]);const c=({node:e,option:a})=>J(R,{placement:"right"},{trigger:()=>e,default:()=>a.label}),w=()=>{var e=[];return e};let y=i(0),S=i(0),k=i(0),h=i(0);const L=i(w()),v=i({page:1,pageSize:15,showSizePicker:!0,pageSizes:[15,30,50],prefix({itemCount:e}){return`共计 ${e}条数据`},onUpdatePageSize:e=>{v.value.pageSize=e,v.value.page=1}}),g=new Intl.NumberFormat("en-US"),C=[];console.log("表格的字段列表columnNames is",P),P.forEach(e=>{let a={title:e,key:e,name:e,minWidth:100,titleAlign:"center",align:"right"};e=="项目特征描述"&&(console.log("项目特征描述字段为：",e),a.align="left",a.width=400),e=="所属工程"&&(console.log("项目特征描述字段为：",e),a.align="left",a.width=200),e=="清单项目名称"&&(console.log("项目特征描述字段为：",e),a.align="center",a.width=200),C.push(a)});async function j(e){const a=await T.post("/DataTools/queryData",{projectName:t.value.selectValueProjectName||"",projectNames:t.value.selectValueProjectNames||["京东方B17项目180K扩产设计项目"],buildingCategory:t.value.selectValueBuildingCategory||"",itemName:t.value.inputValue.itemName||"",itemCharacteristic:t.value.inputValue.itemCharacteristic||"",majorName:t.value.selectValueMajorName||"",packageName:t.value.selectValuePackageName||"",lv1:t.value.selectValueLv1||"",lv2:t.value.selectValueLv2||"",itemLv1:t.value.selectValueItemLv1||"",itemLv2:t.value.selectValueItemLv2||"",page:e,pageSize:v.value.pageSize});v.value.itemCount=a.total,v.value.page=a.page,v.value.pageSize=a.pageSize,v.value.pageCount=a.pageCount,console.log("查询返回res is",a),console.log("查询结果的json数据对象化：",JSON.parse(a.data));let o=JSON.parse(a.data);L.value=[],y.value=a.total_price_sum_filter,S.value=a.total_price_sum1_filter,k.value=a.total_price_sum,h.value=a.total_floorage_sum,console.log("查询结果的数据字段为：",Object.keys(o[0])),o.forEach(f=>{let p={};Object.keys(o[0]).forEach(_=>{p[_]=f[_]}),L.value.push(p)}),["projectNames","lv1","lv2","itemLv1","itemLv2","majorNames","packageNames","buildingNames"].forEach(f=>{s.value[f]=[],JSON.parse(a[f]).forEach(p=>{p&&s.value[f].push({label:p,value:p})})})}j(1);async function D(){j(1)}async function B(e){j(e)}return(e,a)=>(O(),E(M,null,[u(l(q),{justify:"space-between",align:"center"},{default:r(()=>[u(l(x),{bordered:!1},{default:r(()=>[u(l(N),{bordered:!1,type:"success"},{default:r(()=>[d(" 当前筛选结果总价:"+b(l(g).format((l(y)/1e4).toFixed(2)))+"（万元） ",1)]),_:1}),u(l(N),{bordered:!1,type:"success"},{default:r(()=>[d(" 当前筛选结果总价(分摊后的合价):"+b(l(g).format((l(S)/1e4).toFixed(2)))+"（万元） ",1)]),_:1}),u(l(N),{bordered:!1,type:"success"},{default:r(()=>[d(" 该项目总价:"+b(l(g).format((l(k)/1e4).toFixed(2)))+"（万元） ",1)]),_:1}),u(l(N),{bordered:!1,type:"success"},{default:r(()=>[d(" 该项目总面积:"+b(l(g).format(l(h).toFixed(2)))+"（m2） ",1)]),_:1}),u(l(N),{bordered:!1,type:"info"},{default:r(()=>[d(" 该项目单平米指标:"+b(l(g).format((l(k)/l(h)).toFixed(2)))+"（元/m2） ",1)]),_:1})]),_:1})]),_:1}),u(l(A),{inline:"",ref_key:"formRef",ref:z,model:t.value,rules:U,"label-width":"auto","require-mark-placement":"right-hanging",size:F.value},{default:r(()=>[u(l(n),{label:"项目名称",path:"selectValueProjectName"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueProjectName,"onUpdate:value":a[0]||(a[0]=o=>t.value.selectValueProjectName=o),placeholder:"Select",options:s.value.projectNames,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"栋号名称",path:"selectValueBuildingName"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueBuildingCategory,"onUpdate:value":a[1]||(a[1]=o=>t.value.selectValueBuildingCategory=o),placeholder:"Select",options:s.value.buildingNames,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"项目名称",path:"inputValue.itemName"},{default:r(()=>[u(l(I),{value:t.value.inputValue.itemName,"onUpdate:value":a[2]||(a[2]=o=>t.value.inputValue.itemName=o),placeholder:"请输入",clearable:""},null,8,["value"])]),_:1}),u(l(n),{label:"项目特征",path:"inputValue.itemCharacteristic"},{default:r(()=>[u(l(I),{value:t.value.inputValue.itemCharacteristic,"onUpdate:value":a[3]||(a[3]=o=>t.value.inputValue.itemCharacteristic=o),placeholder:"请输入",clearable:""},null,8,["value"])]),_:1}),u(l(n),{label:"包名称",path:"selectValuePackageName"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValuePackageName,"onUpdate:value":a[4]||(a[4]=o=>t.value.selectValuePackageName=o),placeholder:"Select",options:s.value.packageNames,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"专业名称",path:"selectValueMajorName"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueMajorName,"onUpdate:value":a[5]||(a[5]=o=>t.value.selectValueMajorName=o),placeholder:"Select",options:s.value.majorNames,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"一级系统",path:"selectValueLv1"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueLv1,"onUpdate:value":a[6]||(a[6]=o=>t.value.selectValueLv1=o),placeholder:"Select",options:s.value.lv1,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"二级系统",path:"selectValueLv2"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueLv2,"onUpdate:value":a[7]||(a[7]=o=>t.value.selectValueLv2=o),placeholder:"Select",options:s.value.lv2,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"一级物料",path:"selectValueItemLv1"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueItemLv1,"onUpdate:value":a[8]||(a[8]=o=>t.value.selectValueItemLv1=o),placeholder:"Select",options:s.value.itemLv1,"render-option":c,clearable:""},null,8,["value","options"])]),_:1}),u(l(n),{label:"二级物料",path:"selectValueItemLv2"},{default:r(()=>[u(l(m),{filterable:"",value:t.value.selectValueItemLv2,"onUpdate:value":a[9]||(a[9]=o=>t.value.selectValueItemLv2=o),placeholder:"Select",options:s.value.itemLv2,"render-option":c,clearable:""},null,8,["value","options"]),u(l(x),{type:"primary",onClick:D},{default:r(()=>[d(" 搜索 ")]),_:1})]),_:1})]),_:1},8,["model","size"]),u(l(K),{remote:"",ref:"table",columns:C,data:L.value,pagination:v.value,size:F.value,"scroll-x":4e3,"single-line":!1,"onUpdate:page":B,"max-height":"450"},null,8,["data","pagination","size"])],64))}});export{Y as default};
