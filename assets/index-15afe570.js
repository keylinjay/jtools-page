import{p as x,q as b,i as c,s as p,o as I,j as L,w as t,k as e,l as a,t as R,v as j,n as v,x as z,y as B,m as C,z as S,A as T,B as $}from"./index-5554b66c.js";import{N as y,a as q}from"./Checkbox-9d428ad2.js";import{N as f}from"./Space-6a618ca7.js";import{N as D}from"./LayoutContent-b0b542b9.js";import{N as F,a as w}from"./FormItem-729e50bf.js";const h={code:0,data:{token:"admin"}};async function K(m){return h.data.token=m.name,h}const U={login:K},V="JTools",P={__name:"index",setup(m){const g=x(),{query:r}=b(),o=c({name:"admin",password:"12"});N();function N(){const n=p.get("loginInfo");n&&(o.value.name=n.name||"",o.value.password=n.password||"")}const u=c(!0),i=c(!1);async function d(){const{name:n,password:l}=o.value;if(!n||!l){$message.warning("请输入用户名和密码");return}try{i.value=!0,$message.loading("正在验证...");const s=await U.login({name:n,password:l.toString()});if(console.log("当前用户名是：",n),$message.success("登录成功"),T(s.data.token),u.value?p.set("loginInfo",{name:n,password:l}):p.remove("loginInfo"),await $(),r.redirect){const k=r.redirect;Reflect.deleteProperty(r,"redirect"),g.push({path:k,query:r})}else g.push("/")}catch(s){console.error(s),$message.removeMessage()}i.value=!1}function _(){o.value.name="admin",o.value.password="123",d()}return _(),(n,l)=>(I(),L(e(S),{position:"absolute","content-style":"padding: 24px;"},{default:t(()=>[a(e(f),{style:{height:"100%"},justify:"center",align:"center",vertical:"",size:"large"},{default:t(()=>[a(e(R),null,{default:t(()=>[a(e(f),{justify:"center"},{default:t(()=>[a(e(j),{size:24,type:"info"},{default:t(()=>[v(z(V))]),_:1})]),_:1})]),_:1}),a(e(D),{"content-style":"padding: 24px;"},{default:t(()=>[a(e(F),{"label-placement":"left","label-width":"auto"},{default:t(()=>[a(e(w),{label:"用户名："},{default:t(()=>[a(e(y),{value:o.value.name,"onUpdate:value":l[0]||(l[0]=s=>o.value.name=s),autofocus:"",placeholder:"admin",maxlength:20},null,8,["value"])]),_:1}),a(e(w),{label:"密码："},{default:t(()=>[a(e(y),{value:o.value.password,"onUpdate:value":l[1]||(l[1]=s=>o.value.password=s),type:"password","show-password-on":"mousedown",placeholder:"123456",maxlength:20,onKeypress:B(d,["enter"])},null,8,["value"])]),_:1}),a(e(f),{justify:"space-between",align:"center",size:"large"},{default:t(()=>[a(e(q),{checked:u.value,label:"记住我","on-update:checked":s=>u.value=s},null,8,["checked","on-update:checked"]),a(e(C),{type:"primary",loading:i.value,onClick:d},{default:t(()=>[v(" 登录 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{P as default};
